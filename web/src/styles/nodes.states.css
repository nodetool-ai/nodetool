/* NODE STATE STYLES (selection, hover, loading, bypassed) */

/* --------------------------------------------- */
/* Selection and highlighting                     */
/* --------------------------------------------- */
.react-flow__node.selected {
  outline-color: var(
    --node-primary-color,
    var(--palette-text-primary)
  ) !important;
  /* box-shadow: 0 0 0 1px var(--node-primary-color, var(--palette-text-primary)),
    0 10px 30px rgba(0, 0, 0, 0.2); */
}

.react-flow__node:not(.selected) {
  /* Match outline to header background color */
  outline: 1px solid var(--c_node_header_bg) !important;
  /* outline: none; */
  box-shadow: none;
  /* Increase brightness and add slight saturation toward primary */
  /* outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg) 82%,
    var(--palette-primary-main) 18%
  ) !important; */
  /* outline-offset: 1px; */
}

/* Grouped nodes: use group header color for outline */
.react-flow__node:has(.node-header.has-parent):not(.selected) {
  outline-color: var(--c_node_header_bg_group) !important; /* fallback */
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg_group) 82%,
    var(--palette-primary-main) 18%
  ) !important;
}

.react-flow__node:hover:not(.selected) {
  outline: 2px solid var(--c_node_header_bg) !important;
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg) 82%,
    var(--palette-primary-main) 18%
  ) !important;
  outline-offset: 1px;
}

/* Hover for grouped nodes keeps group header color */
.react-flow__node:has(.node-header.has-parent):hover:not(.selected) {
  outline: 1px solid var(--c_node_header_bg_group) !important;
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg_group) 82%,
    var(--palette-primary-main) 18%
  ) !important;
}

/* --------------------------------------------- */
/* Bypassed state                                  */
/* --------------------------------------------- */
.react-flow__node.bypassed {
  opacity: 0.5;
}

.react-flow__node.bypassed .base-node {
  border-style: dashed !important;
  border-width: 2px !important;
  background: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 5px,
    rgba(128, 128, 128, 0.08) 5px,
    rgba(128, 128, 128, 0.08) 10px
  );
}

.react-flow__node.bypassed .node-header .node-title {
  text-decoration: line-through;
  opacity: 0.7;
}

.react-flow__node.bypassed .bypass-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 2px 6px;
  border-radius: 4px;
  background-color: var(--c_warn, rgba(255, 152, 0, 0.2));
  color: var(--palette-warning-main, rgb(255, 152, 0));
  margin-left: 8px;
}

/* Edges from bypassed nodes */
.react-flow__edge.from-bypassed path {
  stroke-dasharray: 5, 5;
  opacity: 0.5;
}

/* --------------------------------------------- */
/* Loading states                                  */
/* --------------------------------------------- */
.react-flow .selected .process-timer {
  color: var(--palette-grey-1000);
  background-color: transparent;
}

/* Loading styles are handled by Emotion in BaseNode.tsx
   The animation uses dynamic colors from node metadata and requires
   mask properties for the ring effect that are better expressed in JS */
