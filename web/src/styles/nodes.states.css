/* NODE STATE STYLES (selection, hover, loading, bypassed) */

/* --------------------------------------------- */
/* Selection and highlighting                     */
/* --------------------------------------------- */
.react-flow__node.selected {
  outline-color: var(
    --node-primary-color,
    var(--palette-text-primary)
  ) !important;
  box-shadow: 0 0 0 1px var(--node-primary-color, var(--palette-text-primary)),
    0 10px 30px rgba(0, 0, 0, 0.2);
}

.react-flow__node:not(.selected) {
  /* Match outline to header background color */
  outline: 1px solid var(--c_node_header_bg) !important;
  /* outline: none; */
  box-shadow: none;
  /* Increase brightness and add slight saturation toward primary */
  /* outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg) 82%,
    var(--palette-primary-main) 18%
  ) !important; */
  /* outline-offset: 1px; */
}

/* Grouped nodes: use group header color for outline */
.react-flow__node:has(.node-header.has-parent):not(.selected) {
  outline-color: var(--c_node_header_bg_group) !important; /* fallback */
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg_group) 82%,
    var(--palette-primary-main) 18%
  ) !important;
}

.react-flow__node:hover:not(.selected) {
  outline: 2px solid var(--c_node_header_bg) !important;
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg) 82%,
    var(--palette-primary-main) 18%
  ) !important;
  outline-offset: 1px;
}

/* Hover for grouped nodes keeps group header color */
.react-flow__node:has(.node-header.has-parent):hover:not(.selected) {
  outline: 1px solid var(--c_node_header_bg_group) !important;
  outline-color: color-mix(
    in srgb,
    var(--c_node_header_bg_group) 82%,
    var(--palette-primary-main) 18%
  ) !important;
}

/* --------------------------------------------- */
/* Bypassed state                                  */
/* --------------------------------------------- */
.react-flow__node:has(.bypassed) {
  opacity: 0.5;
  border-style: dashed !important;
  border-color: var(--palette-grey-600) !important;
  outline-style: dashed !important;
}

.react-flow__node:has(.bypassed):hover {
  opacity: 0.7;
}

.react-flow__node .bypassed {
  background: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 8px,
    rgba(128, 128, 128, 0.08) 8px,
    rgba(128, 128, 128, 0.08) 16px
  );
}

.react-flow__node .bypassed .node-header .node-title {
  text-decoration: line-through;
  opacity: 0.7;
}

.react-flow__node .bypassed .node-content {
  opacity: 0.5;
}

/* --------------------------------------------- */
/* Loading states                                  */
/* --------------------------------------------- */
.react-flow .selected .process-timer {
  color: var(--palette-grey-1000);
  background-color: transparent;
}

/* Loading styles are handled by Emotion in BaseNode.tsx
   The animation uses dynamic colors from node metadata and requires
   mask properties for the ring effect that are better expressed in JS */
