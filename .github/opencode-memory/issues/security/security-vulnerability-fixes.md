### Security Vulnerability Fixes (2026-01-17)

**Vulnerabilities Fixed**:
- **glob command injection (GHSA-5j98-mcp5-4vw2)** - Updated glob via esbuild-style-plugin using npm override (>=10.5.0)
- **tar arbitrary file overwrite (GHSA-8qq5-rm4j-mr97)** - Updated tar to version ^7.5.3 in electron and mobile packages
- **tar via electron-builder** - Fixed by updating direct tar dependency to 7.5.3 and using npm overrides

**Previously Fixed (2026-01-12)**:
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: High

**Impact**: Command injection and arbitrary file overwrite vulnerabilities could allow attackers to execute malicious commands or overwrite files on the user's system.

**Solution**:
- Added npm overrides for `glob` in web/package.json
- Updated `tar` to ^7.5.3 in electron/package.json and mobile/package.json
- Used npm overrides for nested transitive dependencies

**Files Modified**:
- `web/package.json` - Added glob override
- `electron/package.json` - Updated tar dependency to ^7.5.3
- `mobile/package.json` - Added tar override

**Verification**:
- `make typecheck` - PASS (all packages)
- `make lint` - PASS (all packages)
- `npm audit web` - Reduced from 1 high + 9 low to 9 low (glob fixed)
- `npm audit electron` - Reduced from 6 high + 4 moderate + 13 low to 5 moderate + 10 low (tar fixed)
- `npm audit mobile` - Reduced from 2 high + 7 moderate + 1 low to 1 high + 7 moderate + 1 low (tar fixed, prismjs has no fix)

**Remaining Issues**:
- **Mobile**: prismjs XSS vulnerabilities (no fix available from upstream)
- Low severity issues in dev dependencies (diff, @eslint/plugin-kit, etc.)

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches are available. Use npm overrides for transitive dependency vulnerabilities.
