### Security Vulnerability Fixes (2026-01-19)

**Vulnerabilities Fixed**:

1. **glob Command Injection (HIGH)** - Web package via esbuild-style-plugin
   - Added override: `"glob": ">=10.5.0"` in web/package.json
   - Fixes GHSA-5j98-mcp5-4vw2: Command injection via -c/--cmd executes matches with shell:true

2. **tar Arbitrary File Overwrite (HIGH)** - Electron and Mobile packages
   - Electron: Updated tar from `^7.4.3` to `^7.5.3` in package.json
   - Mobile: Added override `"tar": ">=7.5.3"` in package.json
   - Fixes GHSA-8qq5-rm4j-mr97: Arbitrary file overwrite and symlink poisoning

3. **Electron Builder Vulnerabilities (HIGH)** - Electron package
   - Updated electron-builder from `^26.3.4` to `^26.4.0`
   - Fixed @electron/rebuild, app-builder-lib, dmg-builder, electron-builder-squirrel-windows vulnerabilities

**Unfixable Vulnerabilities (No Upstream Fix)**:

4. **prismjs XSS (HIGH)** - Mobile package via react-native-syntax-highlighter
   - No fix available: react-native-syntax-highlighter depends on old unmaintained versions
   - Affected component: Syntax highlighting in mobile app
   - Recommendation: Monitor for updates or consider alternative library

**Code Security Audit Findings**:

- **Input Sanitization**: Properly implemented using `escapeHtml` and `DOMPurify.sanitize`
- **dangerouslySetInnerHTML**: 6 usages found, all properly sanitized:
  - WorkflowTile.tsx: Uses `escapeHtml` + `<wbr>` for word breaks
  - OpenOrCreateDialog.tsx: Uses `escapeHtml` + `<wbr>` for word breaks
  - svg.tsx: Uses `DOMPurify.sanitize` with SVG profiles
  - JSONRenderer.tsx: Uses `DOMPurify.sanitize`

- **Electron Security**: Properly configured
  - contextIsolation: enabled on all windows
  - nodeIntegration: disabled on all windows
  - Preload scripts used for IPC isolation
  - No dangerous patterns found (no eval, no nodeIntegration: true)

- **Secrets Handling**: No hardcoded secrets found
  - API keys stored via SecretsStore
  - Tokens handled via secure HTTP-only mechanisms
  - Proper Authorization header usage

**Verification Results**:

| Package | Before | After |
|---------|--------|-------|
| Web | 1 high, 9 low | 0 high, 9 low |
| Electron | 6 high, 17 moderate/low | 0 high, 17 moderate/low |
| Mobile | 1 high, 9 moderate/low | 1 high (unfixable), 8 moderate/low |

**Quality Checks**:
- ✅ Lint: Passes (1 pre-existing warning)
- ⚠️ Typecheck: 10 pre-existing test errors (unrelated to security fixes)
- ✅ npm audit: See verification results above

**Files Modified**:
- `web/package.json` - Added glob override
- `electron/package.json` - Updated tar and electron-builder versions
- `mobile/package.json` - Added tar override

**Prevention**:
- Run `npm audit` regularly on all packages
- Set up automated dependency vulnerability scanning (Dependabot)
- Review security advisories for transitive dependencies
- Use `overrides` field for transitive vulnerability fixes
