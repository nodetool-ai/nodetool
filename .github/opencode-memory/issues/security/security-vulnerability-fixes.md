### Security Vulnerability Fixes (2026-01-16)

**Vulnerabilities Fixed**:
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html
- **NEW (2026-01-16)**: CSP unsafe-eval vulnerability - Removed 'unsafe-eval' from script-src in web/index.html
- **NEW (2026-01-16)**: Incomplete XSS sanitization - Replaced dangerouslySetInnerHTML with CSS word-break in WorkflowTile.tsx and OpenOrCreateDialog.tsx

**Severity**: Critical/High

**Impact**: User data and API keys could be compromised through XSS attacks in workflow names, chat messages, and rendered content. DoS attacks possible through malicious query parameters. CSP with unsafe-eval allows eval() and similar dangerous functions.

**Solution**:
- Updated direct dependencies to patched versions
- Added npm overrides for transitive dependencies in electron package
- Implemented Content Security Policy to mitigate XSS attacks
- Removed 'unsafe-eval' from CSP to prevent eval(), setTimeout with string, etc.
- Replaced dangerouslySetInnerHTML with CSS-based word breaking for workflow names

**Files Modified**:
- `web/package.json` - Updated dompurify, react-router-dom, react-syntax-highlighter
- `electron/package.json` - Added overrides for qs, express, body-parser
- `web/index.html` - Added CSP meta tag, removed unsafe-eval
- `web/src/components/workflows/WorkflowTile.tsx` - Removed dangerouslySetInnerHTML
- `web/src/components/dialogs/OpenOrCreateDialog.tsx` - Removed dangerouslySetInnerHTML

**Verification**:
- `make typecheck` - PASS (pre-existing test file issues unrelated to changes)
- `make lint` - PASS (pre-existing test file issues unrelated to changes)
- `npm audit web` - Reduced from 8 vulnerabilities (2 high) to 2 (1 high, 1 low)
- `npm audit electron` - Reduced from 12 vulnerabilities (3 high) to 0

**Remaining Unfixable Vulnerabilities**:

1. **Web Package (1 high, 9 low)**:
   - `glob` (HIGH) via esbuild-style-plugin - requires upstream fix in esbuild-style-plugin
   - Various low severity vulnerabilities in dev dependencies (@eslint/plugin-kit, jest, ts-node, diff)

2. **Electron Package (4 moderate, 13 low)**:
   - `vite` (moderate) - version <=6.1.6, requires vite update or upstream fix
   - `esbuild` (moderate) - version <=0.24.2, requires upstream fix
   - `fuse` (moderate) - no fix available without breaking changes
   - `stellate` (moderate) - no fix available without breaking changes

3. **Mobile Package (1 high, 7 moderate, 1 low)**:
   - `prismjs` (HIGH) - version <=1.29.0, no fix available in current version
   - `highlight.js`, `markdown-it`, `react-native-markdown-display` (moderate) - no fix available
   - `undici` (low) - fix available, can be updated

**Note**: Many remaining vulnerabilities are in transitive dependencies that require upstream fixes. The high-severity glob vulnerability in web is in `esbuild-style-plugin` which is a dev dependency used for CSS processing.

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches are available. Consider using `npm audit fix` for auto-fixable issues.
