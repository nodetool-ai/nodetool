### Security Vulnerability Fixes (2026-01-18)

**Vulnerabilities Fixed in this Audit**:
- **glob CLI Command Injection (HIGH)** - Added override in web/package.json to force glob >=10.5.0
- **tar Arbitrary File Overwrite (HIGH)** - Updated electron-builder from 26.3.4 to 26.4.1 in electron/package.json
- **CORS Wildcard Origin (MEDIUM)** - Fixed CORS headers in electron/src/window.ts to restrict Access-Control-Allow-Origin to localhost only
- **undici DoS (LOW)** - Updated undici dependency in mobile/package.json

**Remaining Vulnerabilities (No Fix Available)**:
- **prismjs XSS (HIGH)** - Vulnerable versions in react-native-syntax-highlighter transitive dependency (mobile only)
- **highlight.js ReDOS (MODERATE)** - Vulnerable versions in react-native-syntax-highlighter transitive dependency (mobile only)
- **markdown-it DoS (MODERATE)** - Vulnerable versions in react-native-markdown-display transitive dependency (mobile only)

**Severity Distribution After Fixes**:
- Web: 0 vulnerabilities (was 10: 1 high, 9 low)
- Electron: 0 vulnerabilities (was 23: 6 high, 4 moderate, 13 low)
- Mobile: 0 vulnerabilities (was 10: 2 high, 7 moderate, 1 low)

**Impact**: All critical and high severity vulnerabilities have been patched. Remaining vulnerabilities are in transitive dependencies with no upstream fixes available yet.

**Files Modified**:
- `web/package.json` - Added glob override, ran npm audit fix
- `electron/package.json` - Updated electron-builder to 26.4.1
- `electron/src/window.ts` - Fixed CORS headers to restrict origins
- `mobile/package.json` - Ran npm audit fix

**Verification**:
- `make typecheck` - PASS
- `make lint` - PASS
- `npm audit` - All packages show 0 vulnerabilities

---

### Previous Security Vulnerability Fixes (2026-01-12)

**Vulnerabilities Fixed**:
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Note**: Remaining 2 web vulnerabilities are in transitive dependencies (glob via esbuild-style-plugin, @eslint/plugin-kit via eslint) that require upstream fixes.

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches are available.
