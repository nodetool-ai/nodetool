### Security Vulnerability Fixes (2026-01-17)

**Vulnerabilities Fixed**:
- glob Command Injection (GHSA-5j98-mcp5-4vw2) - High severity - Updated via npm override in web/package.json
- tar Arbitrary File Overwrite (GHSA-8qq5-rm4j-mr97) - High severity - Updated via npm override in mobile/package.json
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (multiple GHSA) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: Critical/High

**Impact**: User data and API keys could be compromised through XSS attacks in workflow names, chat messages, and rendered content. DoS attacks possible through malicious query parameters. Command injection possible through glob CLI.

**Solution**:
- Added npm override for glob@^10.5.0 in web/package.json
- Added npm override for tar@^7.5.3 in mobile/package.json
- Updated direct dependencies to patched versions
- Added npm overrides for transitive dependencies in electron package
- Implemented Content Security Policy to mitigate XSS attacks

**Files Modified**:
- `web/package.json` - Added glob override, updated dompurify, react-router-dom, react-syntax-highlighter
- `mobile/package.json` - Added tar override
- `electron/package.json` - Added overrides for qs, express, body-parser
- `web/index.html` - Added CSP meta tag

**Verification**:
- `make typecheck` - PASS
- `make lint` - PASS
- `npm audit web` - Reduced from 10 vulnerabilities (1 high) to 2 (low)
- `npm audit mobile` - Reduced from 10 vulnerabilities (2 high) to 8 (1 high, 7 moderate)
- `npm audit electron` - 23 vulnerabilities remain (5 high) - build-time issues with electron-builder/tar compatibility

**Note**:
- Remaining electron vulnerabilities are build-time issues in electron-builder and tar that require upstream fixes
- Mobile remaining high vulnerability is in prismjs (no fix available yet)
- Web remaining 2 low vulnerabilities are in eslint/plugin-kit and jest (low severity, no impact)

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches available.

---

### Security Vulnerability Fixes (2026-01-12)

**Vulnerabilities Fixed**:
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: Critical/High

**Impact**: User data and API keys could be compromised through XSS attacks in workflow names, chat messages, and rendered content. DoS attacks possible through malicious query parameters.

**Solution**:
- Updated direct dependencies to patched versions
- Added npm overrides for transitive dependencies in electron package
- Implemented Content Security Policy to mitigate XSS attacks

**Files Modified**:
- `web/package.json` - Updated dompurify, react-router-dom, react-syntax-highlighter
- `electron/package.json` - Added overrides for qs, express, body-parser
- `web/index.html` - Added CSP meta tag

**Verification**:
- `make typecheck` - PASS
- `make lint` - PASS
- `npm audit web` - Reduced from 8 vulnerabilities (2 high) to 2 (1 high, 1 low)
- `npm audit electron` - Reduced from 12 vulnerabilities (3 high) to 0

**Note**: Remaining 2 web vulnerabilities are in transitive dependencies (glob via esbuild-style-plugin, @eslint/plugin-kit via eslint) that require upstream fixes.

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches available.
