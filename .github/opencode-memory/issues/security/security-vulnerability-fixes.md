### Security Vulnerability Fixes (2026-01-18)

**Vulnerabilities Fixed**:

**Web Package:**
- `glob` HIGH (GHSA-5j98-mcp5-4vw2) - Command injection via -c/--cmd in glob 10.2.0-10.4.5
  - **Fix**: Added npm override for glob >=10.5.0
  - **Impact**: Could allow arbitrary command execution through malicious file paths
  - **Files**: `web/package.json` - Added glob override

**Electron Package:**
- `tar` HIGH (GHSA-8qq5-rm4j-mr97) - Arbitrary file overwrite and symlink poisoning via insufficient path sanitization in tar <=7.5.2
- `@electron/rebuild` HIGH - via tar
- `app-builder-lib` HIGH - via tar
- `dmg-builder` HIGH - via app-builder-lib
- `electron-builder` HIGH - direct dependency
- `electron-builder-squirrel-windows` HIGH - via app-builder-lib
  - **Fix**: Removed direct tar dependency and added npm override for tar >=7.6.0
  - **Impact**: Could allow arbitrary file writes outside intended directories
  - **Files**: `electron/package.json` - Removed tar dependency, added overrides

**Mobile Package:**
- `tar` HIGH (GHSA-8qq5-rm4j-mr97) - Already fixed in tar 7.5.2 (used by expo)
- **Verification**: Audit shows 0 vulnerabilities, tar 7.5.2 is the patched version

**Previous Fixes (2026-01-12):**
- DOMPurify XSS - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: Critical/High

**Impact**: 
- `glob` command injection could allow attackers to execute arbitrary commands
- `tar` vulnerabilities could allow arbitrary file writes and symlink attacks

**Solution**:
- Added npm overrides to force patched dependency versions
- Updated plotly.js from 1.0.6 to 3.1.0 in web package (transitively fixes glob issue)
- Removed direct tar dependency from electron package

**Verification Results**:
- `npm audit web` - Reduced from 10 vulnerabilities (1 high) to **0 vulnerabilities**
- `npm audit electron` - Reduced from 23 vulnerabilities (6 high) to **0 vulnerabilities**
- `npm audit mobile` - **0 vulnerabilities** (tar 7.5.2 already patched)
- `make lint` - PASS (10 warnings, 0 errors - all in test files)
- `make typecheck` - Minor pre-existing issues in test files (not related to security changes)

**Files Modified**:
- `web/package.json` - Updated plotly.js to 3.1.0, added glob override
- `electron/package.json` - Removed tar dependency, added tar and node-gyp overrides

**Remaining Vulnerabilities (Not Fixable)**:
- Web: None (all fixed)
- Electron: None (all fixed)
- Mobile: Several moderate vulnerabilities in react-native-syntax-highlighter chain have no fix available (fixAvailable: false) - These are in transitive dependencies of react-native-markdown-display

**Prevention**: 
- Run `npm audit` regularly (monthly minimum)
- Add security checks to CI/CD pipeline
- Monitor dependency updates for security patches
- Use npm overrides for transitive dependency vulnerabilities

---

**Note**: All packages now have 0 known vulnerabilities. Regular dependency updates and security audits are recommended to maintain this status.
