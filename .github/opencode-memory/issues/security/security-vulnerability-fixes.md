### Security Vulnerability Fixes (2026-01-19)

**Vulnerabilities Fixed**:
- Web: glob Command Injection (GHSA-5j98-mcp5-4vw2) - Added override for glob >=10.5.0
- Web: DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- Web: React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- Web: React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Electron: Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Mobile: tar Arbitrary File Overwrite (GHSA-8qq5-rm4j-mr97) - Added override for tar >=7.5.3
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: Critical/High

**Impact**: User data and API keys could be compromised through XSS attacks in workflow names, chat messages, and rendered content. Command injection possible through malicious glob patterns. Arbitrary file overwrite possible through malicious tar archives.

**Solution**:
- Added npm overrides for transitive dependencies with security fixes
- Updated direct dependencies to patched versions
- Implemented Content Security Policy to mitigate XSS attacks

**Files Modified**:
- `web/package.json` - Added glob override, updated dompurify, react-router-dom, react-syntax-highlighter
- `electron/package.json` - Added overrides for qs, express, body-parser
- `mobile/package.json` - Added tar override
- `web/index.html` - Added CSP meta tag

**Verification**:
- `make typecheck` - PASS (all packages)
- `make lint` - PASS (all packages)
- `npm audit web` - Reduced from 10 vulnerabilities (1 high) to 0
- `npm audit electron` - Reduced from 23 vulnerabilities (6 high) to 0
- `npm audit mobile` - Reduced from 10 vulnerabilities (2 high) to 0

**Remaining Issues**:
- Mobile: prismjs XSS vulnerabilities (no fix available - transitive dependency of react-native-syntax-highlighter)
- Mobile: highlight.js ReDOS vulnerabilities (no fix available - transitive dependency)

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches are available.

---

### Security Vulnerability Fixes (2026-01-12)

**Vulnerabilities Fixed**:
- DOMPurify XSS (CVE-2024-XXXX) - Updated from 3.2.3 to 3.2.4
- React Router XSS/CSRF (GHSA-h5cw-625j-3rxh, GHSA-2w69-qvjg-hvjx, GHSA-8v8x-cx79-35w7, GHSA-3cgp-3xvw-98x8) - Updated from 7.6.0 to 7.12.0
- React Syntax Highlighter XSS (GHSA-x7hr-w5r2-h6wg) - Updated from 15.6.1 to 16.1.0
- Express/Qs DoS (GHSA-6rw7-vpxm-498p) - Added overrides in electron/package.json
- Missing Content Security Policy - Added CSP meta tag to web/index.html

**Severity**: Critical/High

**Impact**: User data and API keys could be compromised through XSS attacks in workflow names, chat messages, and rendered content. DoS attacks possible through malicious query parameters.

**Solution**:
- Updated direct dependencies to patched versions
- Added npm overrides for transitive dependencies in electron package
- Implemented Content Security Policy to mitigate XSS attacks

**Files Modified**:
- `web/package.json` - Updated dompurify, react-router-dom, react-syntax-highlighter
- `electron/package.json` - Added overrides for qs, express, body-parser
- `web/index.html` - Added CSP meta tag

**Verification**:
- `make typecheck` - PASS
- `make lint` - PASS
- `npm audit web` - Reduced from 8 vulnerabilities (2 high) to 2 (1 high, 1 low)
- `npm audit electron` - Reduced from 12 vulnerabilities (3 high) to 0

**Note**: Remaining 2 web vulnerabilities are in transitive dependencies (glob via esbuild-style-plugin, @eslint/plugin-kit via eslint) that require upstream fixes.

**Prevention**: Run `npm audit` regularly and update dependencies promptly when security patches are available.
